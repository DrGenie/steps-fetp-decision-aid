<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>STEPS Technical Appendix – FETP India</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --text:#0f172a; --soft:#f9fafb; --blue:#1D4F91; --border:#E5E7EB;
    }
    body{margin:24px; color:var(--text); font:15px/1.6 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial}
    h1,h2,h3{color:#0b1120;margin:0 0 8px}
    h1{font-size:1.7rem} h2{font-size:1.3rem;margin-top:22px} h3{font-size:1.1rem;margin-top:18px}
    p{margin:8px 0}
    code,.code{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;background:#e5e7eb;padding:0 4px;border-radius:4px}
    .box{background:var(--soft);border:1px solid var(--border);border-radius:10px;padding:12px;margin:10px 0}
    .table{width:100%;border-collapse:separate;border-spacing:0;border:1px solid var(--border);border-radius:10px;overflow:hidden}
    .table th,.table td{padding:10px 12px;border-bottom:1px solid var(--border);vertical-align:top}
    .table thead th{background:#f3f4f6}
    .note{color:#475569}
  </style>
</head>
<body>
  <h1>STEPS Technical Appendix – FETP India</h1>
  <p>
    This appendix explains how STEPS turns preference estimates, cost templates and epidemiological multipliers into endorsement,
    willingness to pay, costs and national summaries. All calculations in the app are in INR. USD is a display option only.
  </p>

  <h2>1. Preference model and utilities</h2>
  <p>
    The study used a three-alternative design: Training A, Training B and an opt out. Each training option included:
    programme tier, career incentive, mentorship intensity, delivery mode, response time and cost per trainee per month.
  </p>
  <p>
    STEPS offers two preference models:
  </p>
  <ul>
    <li><strong>Average mixed logit (MXL)</strong> with mean coefficients and a back-transformed cost coefficient <code>β_cost = -0.005</code> per thousand INR.</li>
    <li><strong>Supportive latent class (LC2)</strong> with <code>β_cost = -0.001</code>.</li>
  </ul>
  <div class="box">
    <strong>Systematic utility for a chosen programme</strong><br>
    <span class="note">Symbols: ASC_A is the constant for the offered programme and ASC_O is the opt out constant.</span><br>
    <span class="code">V_prog = ASC_A + Σ β_k x_k + β_cost · (Cost / 1000)</span><br>
    <span class="code">ΔV = - ASC_O + V_prog</span>
  </div>
  <p>
    STEPS builds <code>V_prog</code> from the selected levels using the model you pick. Cost is in INR per trainee per month and divided by 1000 when multiplied by <code>β_cost</code>.
  </p>

  <h3>Worked example: utilities</h3>
  <p>
    Suppose you choose: <em>Advanced, high mentorship, blended, response within 7 days, university qualification, cost 100,000 INR</em>.
    Using MXL means:
  </p>
  <ul>
    <li>ASC_A = 0.168</li>
    <li>Advanced = 0.487; University qualification = 0.017; High mentorship = 0.640; Blended = 0; Response 7 days = 0.610</li>
    <li>Cost term = <code>-0.005 × (100,000 / 1000) = -0.5</code></li>
    <li>Opt out ASC = -0.601</li>
  </ul>
  <p><code>V_prog = 0.168 + 0.487 + 0.017 + 0.640 + 0 + 0.610 - 0.5 = 1.422</code></p>
  <p><code>ΔV = -(-0.601) + 1.422 = 2.023</code></p>

  <h2>2. Endorsement probabilities</h2>
  <p>
    Endorsement is the probability that a stakeholder selects any FETP programme rather than opting out. With the single index <code>ΔV</code>:
  </p>
  <div class="box"><span class="code">P(endorse) = 1 / (1 + exp(-ΔV))</span></div>
  <p>
    Continuing the example, <code>P(endorse) = 1 / (1 + exp(-2.023)) ≈ 0.883</code>, or 88.3 percent.
  </p>

  <h2>3. Willingness to pay (WTP)</h2>
  <p>
    For a linear cost term, WTP for moving from baseline to a level is:
  </p>
  <div class="box"><span class="code">WTP_level = - β_level / β_cost × 1000</span> <span class="note">(INR per trainee per month)</span></div>
  <p>
    With MXL, examples are: Intermediate ≈ 44k–48k INR; Advanced ≈ 100k–104k; High mentorship ≈ 128k–138k; 7 days response ≈ 120k–132k.
    The Results tab lists the WTP table for the currently selected model.
  </p>

  <h2>4. Costs</h2>
  <p>
    Programme cost per cohort multiplies cost per trainee per month by trainees and programme duration in months:
  </p>
  <div class="box"><span class="code">C_prog = CostPerTraineePerMonth × Trainees × DurationMonths</span></div>
  <p>
    Total economic cost adds opportunity cost when the toggle is on:
  </p>
  <div class="box"><span class="code">C_econ = C_prog × (1 + OppShare)</span></div>

  <h3>Worked example: costs</h3>
  <p>
    Advanced, 20 trainees, duration 24 months, monthly cost 100,000 INR, opportunity cost share 0.22:
  </p>
  <p><code>C_prog = 100,000 × 20 × 24 = 48,000,000 INR</code></p>
  <p><code>C_econ = 48,000,000 × 1.22 = 58,560,000 INR</code></p>
  <p>
    The Costing details tab allocates <code>C_prog</code> across components using the selected template shares.
  </p>

  <h2>5. Epidemiological multipliers and indicative benefit</h2>
  <p>
    STEPS uses four multipliers per tier: graduates per cohort (share of trainees), outbreak responses per cohort per year,
    value per graduate and value per outbreak response. Defaults are editable in Advanced & methods.
  </p>
  <div class="box">
    <span class="code">Graduates_per_cohort = Trainees × GradRate × P(endorse)</span><br>
    <span class="code">Outbreaks_per_cohort_per_year = OutbreakMultiplier × P(endorse)</span><br>
    <span class="code">Benefit_per_cohort = Graduates × ValuePerGraduate + Outbreaks × ValuePerOutbreak</span>
  </div>

  <h3>Worked example: indicative benefit</h3>
  <p>
    Advanced defaults: grad rate 0.95; outbreaks 0.80 per cohort per year; values 800,000 and 30,000,000 INR.
    With 20 trainees, <code>P(endorse)=0.883</code>:
  </p>
  <p><code>Graduates = 20 × 0.95 × 0.883 ≈ 16.8</code></p>
  <p><code>Outbreaks = 0.80 × 0.883 ≈ 0.71</code></p>
  <p><code>Benefit = 16.8 × 800,000 + 0.71 × 30,000,000 ≈ 13.4m + 21.3m = 34.7m INR</code></p>

  <h2>6. Net benefit and benefit–cost ratio</h2>
  <div class="box">
    <span class="code">Net = Benefit_per_cohort - C_econ</span> &nbsp; · &nbsp;
    <span class="code">BCR = Benefit_per_cohort / C_econ</span>
  </div>
  <p>
    Using the example: <code>Net ≈ 34.7m - 58.6m = -23.9m</code>, <code>BCR ≈ 0.59</code>. This suggests testing lower monthly cost,
    stronger mentorship or different tier to improve value for money.
  </p>

  <h2>7. National simulation</h2>
  <p>
    National totals multiply per cohort values by the number of cohorts:
  </p>
  <div class="box">
    <span class="code">TotalCost = C_econ × Cohorts</span><br>
    <span class="code">TotalBenefit = Benefit_per_cohort × Cohorts</span><br>
    <span class="code">TotalGraduates = Graduates_per_cohort × Cohorts</span><br>
    <span class="code">OutbreakResponsesPerYear = Outbreaks_per_cohort_per_year × Cohorts</span>
  </div>

  <h2>8. Matching UI scenarios</h2>
  <p>
    The app includes presets that match the worked examples above. For instance:
  </p>
  <ul>
    <li>Advanced, high mentorship, blended, 7 days, university qualification, 100k monthly cost.</li>
    <li>Intermediate, medium mentorship, blended, 15 days, certificate, 250k monthly cost.</li>
  </ul>

  <h2>9. Parameters and editing</h2>
  <p>
    Edit <span class="code">epi_config.json</span> to change durations, multipliers, values and cost templates. Do not remove components; adjust shares so they sum to 1. Opportunity cost share applies when the toggle is on.
  </p>

  <h2>10. Notes</h2>
  <ul>
    <li>All monetary values are indicative and should be updated with country-agreed parameters during workshops.</li>
    <li>WTP is based on linear cost terms and model means. It is a useful sensitivity indicator, not a budget line.</li>
    <li>For major investments, cross-check with detailed burden of disease or health security models.</li>
  </ul>
</body>
</html>
